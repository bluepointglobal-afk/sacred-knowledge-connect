# Ghosty Ship-All Integration Roadmap

## Overview

This roadmap integrates the universal ship-all pipeline into your workflow. The system provides:

1. **Agent-generated SCOPE.md** - Extracted from conversation, not manually filled
2. **`make ship`** - Single command orchestration from Ghostty
3. **Template repo structure** - Clone into any project
4. **CI wiring** - GitHub Actions integration
5. **Learning memory** - Compounds across iterations

---

## How It Works

```
User describes project
        ↓
Agent extracts SCOPE (Phase 0: Discovery)
        ↓
Agent generates SCOPE.md
        ↓
Agent creates Architecture + PRD (Phase 1-2)
        ↓
Ralph executes stories (Phase 3)
        ↓
Validation adapter runs (Phase 4)
        ↓
Ship gate: pass/fail (Phase 5)
        ↓
Memory records learnings
```

**Key principle:** SCOPE.md is an OUTPUT of agent discovery, not an INPUT you fill manually.

---

## Step 1: Copy Files to Your Project

From Ghostty terminal:

```bash
# Navigate to your project
cd /path/to/your/project

# Create directory structure
mkdir -p scripts/{validation,util,memory,ralph,discovery} reports .github/workflows tasks

# Copy all files from the template
# (Or use this as a Git submodule / template repo)
```

### Files to Copy

```
.
├── STATUS.md                         # Progress tracking
├── Makefile                          # make ship entrypoint
├── scripts/
│   ├── ship.sh                       # Main orchestration
│   ├── ship-all.md                   # Playbook reference
│   ├── discovery/
│   │   └── DISCOVERY_PROTOCOL.md     # Agent discovery instructions
│   ├── ralph/
│   │   └── ralph.sh                  # Governed execution loop
│   ├── validation/
│   │   ├── run_validation.sh         # Adapter selector
│   │   ├── saas.md                   # SaaS validation
│   │   ├── mobile.md                 # Mobile validation
│   │   ├── web.md                    # Web validation
│   │   ├── api.md                    # API validation
│   │   └── content.md                # Content validation
│   ├── util/
│   │   ├── generate_scope.sh         # SCOPE.md generator (agent calls this)
│   │   ├── detect_product_type.sh    # SCOPE.md parser
│   │   ├── require_files.sh          # Dependency checker
│   │   └── convert_prd_to_prdjson.sh # PRD → Ralph converter
│   └── memory/
│       └── memory.sh                 # Learning memory system
├── reports/                          # Generated reports go here
├── tasks/                            # PRD/task files go here
└── .github/workflows/
    └── ship-ci.yml                   # CI integration
```

**Note:** SCOPE.md is NOT in the template. It's generated by the agent.

---

## Step 2: Make Scripts Executable

```bash
chmod +x scripts/ship.sh \
  scripts/util/generate_scope.sh \
  scripts/util/detect_product_type.sh \
  scripts/util/require_files.sh \
  scripts/util/convert_prd_to_prdjson.sh \
  scripts/validation/run_validation.sh \
  scripts/memory/memory.sh \
  scripts/ralph/ralph.sh
```

---

## Step 3: Discovery Phase (Agent-Driven)

When you describe your project to Claude, the agent:

1. **Extracts** structured data from conversation
2. **Confirms** understanding with you
3. **Generates** SCOPE.md

### Example Conversation

**You:** I need a platform where GCC SMEs can generate ESG reports. They upload some data, answer questions, and get a PDF report they can submit to regulators.

**Agent:** Based on our conversation:

- **Product Type:** SaaS
- **Market:** B2B  
- **Persona:** SME (GCC region)
- **Outcome:** SMEs generate compliant ESG reports in 30 minutes

**Deliverables:**
- ESG data input wizard
- Compliance scoring engine
- PDF report generator (Arabic/English)

**Success Criteria:**
- First report in < 30 min
- Passes basic regulatory alignment
- Works on mobile browser

Does this capture your intent?

**You:** Yes, also needs to support Arabic RTL.

**Agent:** Got it. Generating SCOPE.md...

```bash
bash scripts/util/generate_scope.sh --json '{
  "product_type": "SaaS",
  "market": "B2B",
  "persona": "SME",
  "outcome": "GCC SMEs generate compliant ESG reports in 30 minutes",
  "deliverables": [
    "ESG data input wizard",
    "Compliance scoring engine", 
    "PDF report generator (Arabic/English)"
  ],
  "success_criteria": [
    "First report in < 30 minutes",
    "Passes basic regulatory alignment",
    "Works on mobile browser"
  ],
  "context": "GCC regulators requiring ESG disclosure from SMEs",
  "constraints": ["Must support Arabic RTL"]
}'
```

**SCOPE.md created. Proceeding to architecture...**

---

## Step 4: Agent Creates PRD

After SCOPE.md exists, the agent:

1. Designs architecture based on SCOPE
2. Creates PRD in `tasks/tasks-<feature>.md`
3. Converts to Ralph stories

```bash
# Agent creates tasks file, then converts
make prd-to-ralph FEATURE=esg-wizard NAME="ESG Wizard"
```

---

## Step 5: Edit Verifiers for Your Stack

After `scripts/ralph/prd.json` is created, edit verifiers:

```json
"verifiers": [
  "pnpm lint",
  "pnpm typecheck",
  "pnpm test"
]
```

---

## Step 6: Run Ralph Loop

```bash
make ralph
```

Ralph shows stories one at a time. Agent implements, verifiers run, commits happen automatically.

---

## Step 7: Ship

```bash
make ship
```

Full pipeline:
1. Checks SCOPE.md exists (from discovery)
2. Runs Ralph if prd.json exists
3. Runs validation adapter (based on product type)
4. Gates on score threshold
5. Records learnings to memory

---

## Daily Workflow

### Starting a New Project

```
1. Describe project to agent (conversation)
2. Agent extracts and confirms SCOPE
3. Agent generates SCOPE.md
4. Agent creates architecture + PRD
5. make ralph (implementation)
6. make ship (validation + ship gate)
```

### You Never Manually Write SCOPE.md

The agent writes it. You confirm it. That's the contract.

---

## Agent Protocol Summary

The agent follows `scripts/discovery/DISCOVERY_PROTOCOL.md`:

| Step | Agent Action |
|------|--------------|
| EXTRACT | Pull structure from conversation |
| CONFIRM | Show user what was understood |
| GENERATE | Call `generate_scope.sh --json` |
| LOCK | Mark SCOPE as immutable for this cycle |

---

## Command Reference

| Command | What it does |
|---------|--------------|
| `make scope JSON='{...}'` | Generate SCOPE.md (agent calls this) |
| `make ship` | Full pipeline |
| `make ship-dry` | Preview without executing |
| `make ship-validate` | Run only validation |
| `make ralph` | Run story loop |
| `make ship-memory` | Show learnings |
| `make prd-to-ralph FEATURE=x NAME="Y"` | Convert PRD to stories |

---

## Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                     DISCOVERY (Phase 0)                         │
│  User conversation → Agent extracts → SCOPE.md generated        │
└──────────────────────────────┬──────────────────────────────────┘
                               │
                               ▼
┌─────────────────────────────────────────────────────────────────┐
│                        make ship                                 │
│                            │                                     │
│  ┌─────────────┐   ┌──────┴──────┐   ┌─────────────────────┐   │
│  │  SCOPE.md   │──▶│   ship.sh   │──▶│ Validation Adapter  │   │
│  │ (generated) │   │             │   │  (SaaS/Mobile/Web)  │   │
│  └─────────────┘   │  ┌───────┐  │   └──────────┬──────────┘   │
│                    │  │ Ralph │  │              │              │
│                    │  │ Loop  │  │              ▼              │
│                    │  └───────┘  │      ┌──────────────┐       │
│                    │             │      │  SCORE.json  │       │
│                    │  ┌───────┐  │      └──────┬───────┘       │
│                    │  │Memory │◀─┼─────────────┘               │
│                    │  │System │  │                             │
│                    │  └───────┘  │                             │
│                    └─────────────┘                             │
└─────────────────────────────────────────────────────────────────┘
```

---

**SCOPE.md is agent-produced. You describe. Agent extracts. Pipeline executes.**
